name: YouTube Automation (ìˆ˜ìµ ì°½ì¶œ ë´‡)

on:
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ ê¸°ëŠ¥

jobs:
  build-and-upload:
    runs-on: ubuntu-latest

    steps:
    - name:  checkout code
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'
        cache: 'pip'

    # ğŸ”¥ ì—¬ê¸°ê°€ ë‘ ë²ˆì§¸ í•µì‹¬! Pillowì— í•„ìš”í•œ ê·¸ë¦¼ ë„êµ¬ë¥¼ ë¨¼ì € ì„¤ì¹˜í•©ë‹ˆë‹¤.
    - name: Install System Dependencies for Pillow
      run: |
        sudo apt-get update
        sudo apt-get install -y libjpeg-dev zlib1g-dev libfreetype6-dev

    - name: Install Python Dependencies
      run: |
        set -e # ì—ëŸ¬ ë°œìƒ ì‹œ ì¦‰ì‹œ ì¤‘ë‹¨
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    # ğŸ”¥ ì—¬ê¸°ê°€ ì„¸ ë²ˆì§¸ í•µì‹¬! OpenCVê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸ì‚¬ì‚´í•©ë‹ˆë‹¤.
    - name: Verify No OpenCV Installation
      run: |
        echo "ğŸš« OpenCV ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸ (ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë©´ ì—¬ê¸°ì„œ ì‹¤íŒ¨í•´ì•¼ ì •ìƒ)"
        # ì•„ë˜ ëª…ë ¹ì–´ê°€ ì„±ê³µí•˜ë©´(cv2ê°€ ì—†ìœ¼ë©´) ë‹¤ìŒ ë‹¨ê³„ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.
        ! python -c "import cv2" && echo "âœ… ì¢‹ìŠµë‹ˆë‹¤! OpenCVê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."

    - name: Run YouTube Automation Bot
      env:
        # ğŸ”¥ ì¤‘ìš”: GitHub Secrets ì´ë¦„ê³¼ ì •í™•íˆ ì¼ì¹˜ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.
        OPENAI_KEYS_JSON: ${{ secrets.OPENAI_KEYS_JSON }}
        GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        ELEVENLABS_API_KEY: ${{ secrets.ELEVENLABS_API_KEY }}
        PEXELS_API_KEY: ${{ secrets.PEXELS_API_KEY }}
        YOUTUBE_OAUTH_CREDENTIALS: ${{ secrets.YOUTUBE_OAUTH_CREDENTIALS }}
      run: |
        python src/main.py
